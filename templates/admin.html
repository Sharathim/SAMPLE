<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin panel for managing Notes Dock content">
    <title>Admin - Notes Dock</title>
    <link rel="icon" href="{{ url_for('static', filename='assets/logo.png') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/subject.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>

<body>
    <header class="header">
        <div class="header-brand">
            <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="Notes Dock Logo" class="header-logo">
            <h1 class="site-title">Notes Dock</h1>
        </div>
        <nav class="header-nav">
            <a onclick="logoutAdmin()"><b>Logout</b></a>
        </nav>
    </header>

    <main class="main-content">
        <div class="admin-content">
            <!-- Admin Header -->
            <div class="admin-header">
                <h1 class="admin-title">Admin Dashboard</h1>
                <p class="admin-subtitle">Manage subjects, units, and monitor platform statistics</p>
            </div>

            <!-- Admin Tab Selection -->
            <div class="admin-selector">
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="showAdminSection('upload')">
                        <i class="fas fa-upload"></i> Upload
                    </button>
                    <button class="admin-tab" onclick="showAdminSection('manage')">
                        <i class="fas fa-cog"></i> Manage
                    </button>
                    <button class="admin-tab" onclick="showAdminSection('overview')">
                        <i class="fas fa-chart-bar"></i> Overview
                    </button>
                </div>
            </div>

            <!-- Upload Section -->
            <div id="upload-section" class="admin-section active">
                <div class="section-header">
                    <h2 class="section-title">Create New Subject & Unit</h2>
                    <p class="section-subtitle">Add new educational content to the platform</p>
                </div>

                <div class="upload-container">
                    <form class="form-grid" id="uploadForm">
                        <div class="form-group">
                            <label class="form-label" for="subjectSelect">
                                <i class="fas fa-book"></i>
                                Subject
                            </label>
                            <select class="form-select" id="subjectSelect" onchange="toggleNewSubject()">
                                <option value="">Select existing subject or create new</option>
                                <option value="tamil">Tamil</option>
                                <option value="english">English</option>
                                <option value="statistics">Statistics</option>
                                <option value="java">Java</option>
                                <option value="html">HTML</option>
                                <option value="new">+ Create New Subject</option>
                            </select>
                        </div>

                        <div class="form-group" id="newSubjectGroup" style="display: none;">
                            <label class="form-label" for="newSubjectName">
                                <i class="fas fa-tag"></i>
                                New Subject Name
                            </label>
                            <input type="text" class="form-input" id="newSubjectName"
                                placeholder="Enter new subject name">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="unitNumber">
                                    <i class="fas fa-hashtag"></i>
                                    Unit Number
                                </label>
                                <input type="number" class="form-input" id="unitNumber" min="1" max="10"
                                    placeholder="e.g., 1">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="unitIcon">
                                    <i class="fas fa-icons"></i>
                                    Unit Icon (Font Awesome)
                                </label>
                                <input type="text" class="form-input" id="unitIcon" placeholder="e.g., fas fa-book">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="unitTitle">
                                <i class="fas fa-heading"></i>
                                Unit Title
                            </label>
                            <input type="text" class="form-input" id="unitTitle" placeholder="Enter unit title"
                                required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="unitDescription">
                                <i class="fas fa-align-left"></i>
                                Unit Description
                            </label>
                            <textarea class="form-textarea" id="unitDescription" placeholder="Enter unit description"
                                required></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="unitTopics">
                                <i class="fas fa-list-ul"></i>
                                Topics (separate with commas)
                            </label>
                            <textarea class="form-textarea" id="unitTopics" placeholder="Topic 1, Topic 2, Topic 3..."
                                required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="topicsCount">
                                    <i class="fas fa-calculator"></i>
                                    Topics Count
                                </label>
                                <input type="number" class="form-input" id="topicsCount" placeholder="Auto-calculated"
                                    readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="pagesCount">
                                    <i class="fas fa-file-alt"></i>
                                    Pages Count
                                </label>
                                <input type="number" class="form-input" id="pagesCount" min="1"
                                    placeholder="Enter pages count" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-file-upload"></i>
                                Upload Notes File
                            </label>
                            <div class="file-upload-area" id="fileUploadArea">
                                <input type="file" class="file-upload-input" id="notesFile"
                                    accept=".pdf,.doc,.docx,.ppt,.pptx" onchange="handleFileSelect(this)">
                                <div class="file-upload-content">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <div class="file-upload-text">Choose a file or drag it here</div>
                                    <div class="file-upload-hint">Supports PDF, DOC, DOCX, PPT, PPTX (Max 10MB)</div>
                                </div>
                            </div>
                            <div class="file-info" id="fileInfo">
                                <div class="file-info-text" id="fileInfoText"></div>
                            </div>
                        </div>
                        <center>
                            <button type="submit" class="submit-btn" id="submitBtn">
                                <i class="fas fa-save"></i>
                                Create Unit
                            </button>
                        </center>
                        <div class="message success-message" id="successMessage"></div>
                        <div class="message error-message" id="errorMessage"></div>
                    </form>
                </div>
            </div>

            <!-- Manage Section -->
            <div id="manage-section" class="admin-section">
                <div class="section-header">
                    <h2 class="section-title">Manage Content</h2>
                    <p class="section-subtitle">Edit and organize existing subjects and units</p>
                </div>

                <!-- Search and Filter Controls -->
                <div class="manage-controls">
                    <div class="search-filter-bar">
                        <div class="search-group">
                            <i class="fas fa-search"></i>
                            <input type="text" class="search-input" id="searchInput"
                                placeholder="Search subjects, units, or topics..." oninput="filterContent()">
                        </div>
                        <div class="filter-group">
                            <select class="filter-select" id="subjectFilter" onchange="filterContent()">
                                <option value="">All Subjects</option>
                                <option value="tamil">Tamil</option>
                                <option value="english">English</option>
                                <option value="statistics">Statistics</option>
                                <option value="java">Java</option>
                                <option value="html">HTML</option>
                            </select>
                        </div>
                        <button class="refresh-btn" onclick="refreshManageData()">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                </div>

                <!-- Content Management Area -->
                <div class="manage-content">
                    <div id="noDataMessage" class="no-data-message">
                        <div class="no-data-icon">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <div class="no-data-text">No content available</div>
                        <div class="no-data-subtext">Create your first subject and unit in the Upload section</div>
                    </div>

                    <div id="manageDataContainer" class="manage-data-container">
                        <!-- Dynamic content will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Edit Unit Modal -->
            <div class="modal-overlay" id="editModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">
                            <i class="fas fa-edit"></i>
                            Edit Unit
                        </h3>
                    </div>
                    <div class="modal-body">
                        <form class="form-grid" id="editForm">
                            <input type="hidden" id="editUnitId">
                            <input type="hidden" id="editSubjectKey">

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="editUnitNumber">
                                        <i class="fas fa-hashtag"></i>
                                        Unit Number
                                    </label>
                                    <input type="number" class="form-input" id="editUnitNumber" min="1" max="10">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="editUnitIcon">
                                        <i class="fas fa-icons"></i>
                                        Unit Icon
                                    </label>
                                    <input type="text" class="form-input" id="editUnitIcon">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="editUnitTitle">
                                    <i class="fas fa-heading"></i>
                                    Unit Title
                                </label>
                                <input type="text" class="form-input" id="editUnitTitle" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="editUnitDescription">
                                    <i class="fas fa-align-left"></i>
                                    Unit Description
                                </label>
                                <textarea class="form-textarea" id="editUnitDescription" required></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="editUnitTopics">
                                    <i class="fas fa-list-ul"></i>
                                    Topics (separate with commas)
                                </label>
                                <textarea class="form-textarea" id="editUnitTopics" required></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="editTopicsCount">
                                        <i class="fas fa-calculator"></i>
                                        Topics Count
                                    </label>
                                    <input type="number" class="form-input" id="editTopicsCount" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="editPagesCount">
                                        <i class="fas fa-file-alt"></i>
                                        Pages Count
                                    </label>
                                    <input type="number" class="form-input" id="editPagesCount" min="1" required>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="modal-btn secondary" onclick="closeEditModal()">Cancel</button>
                        <button class="modal-btn primary" onclick="saveUnitEdit()">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
            </div>

            <!-- Replace File Modal -->
            <div class="modal-overlay" id="replaceFileModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">
                            <i class="fas fa-file-upload"></i>
                            Replace File
                        </h3>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" id="replaceUnitId">
                        <input type="hidden" id="replaceSubjectKey">

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-file-upload"></i>
                                Upload New File
                            </label>
                            <div class="file-upload-area" id="replaceFileUploadArea">
                                <input type="file" class="file-upload-input" id="replaceFile"
                                    accept=".pdf,.doc,.docx,.ppt,.pptx" onchange="handleReplaceFileSelect(this)">
                                <div class="file-upload-content">
                                    <div class="file-upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <div class="file-upload-text">Choose a new file or drag it here</div>
                                    <div class="file-upload-hint">Supports PDF, DOC, DOCX, PPT, PPTX (Max 10MB)</div>
                                </div>
                            </div>
                            <div class="file-info" id="replaceFileInfo">
                                <div class="file-info-text" id="replaceFileInfoText"></div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="modal-btn secondary" onclick="closeReplaceFileModal()">Cancel</button>
                        <button class="modal-btn primary" onclick="saveFileReplace()">
                            <i class="fas fa-upload"></i> Replace File
                        </button>
                    </div>
                </div>
            </div>
            <!-- Replace the existing overview section with this -->
            <div id="overview-section" class="admin-section">
                <div class="section-header">
                    <h2 class="section-title">Platform Overview</h2>
                    <p class="section-subtitle">Monitor statistics and platform performance</p>
                </div>

                <!-- Statistics Dashboard -->
                <div class="stats-dashboard">
                    <!-- Main Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card primary">
                            <div class="stat-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalSubjects">0</div>
                                <div class="stat-label">Total Subjects</div>
                            </div>
                        </div>

                        <div class="stat-card success">
                            <div class="stat-icon">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalUnits">0</div>
                                <div class="stat-label">Total Units</div>
                            </div>
                        </div>

                        <div class="stat-card warning">
                            <div class="stat-icon">
                                <i class="fas fa-file-upload"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalFiles">0</div>
                                <div class="stat-label">Files Uploaded</div>
                            </div>
                        </div>

                        <div class="stat-card info">
                            <div class="stat-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="visitorCount">0</div>
                                <div class="stat-label">Page Visits</div>
                            </div>
                        </div>

                        <div class="stat-card secondary">
                            <div class="stat-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="downloadCount">0</div>
                                <div class="stat-label">Downloads</div>
                            </div>
                        </div>

                        <div class="stat-card danger">
                            <div class="stat-icon">
                                <i class="fas fa-hdd"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-number" id="totalStorage">0 MB</div>
                                <div class="stat-label">Storage Used</div>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Overview -->
                    <div class="activity-section">
                        <div class="activity-card">
                            <div class="activity-header">
                                <h3 class="activity-title">
                                    <i class="fas fa-chart-line"></i>
                                    Recent Activity
                                </h3>
                                <button class="refresh-activity-btn" onclick="refreshOverviewStats()">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                            <div class="activity-content" id="activityContent">
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-info-circle"></i>
                                    </div>
                                    <div class="activity-text">Platform initialized</div>
                                    <div class="activity-time">Just now</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions-section">
                        <div class="quick-actions-card">
                            <div class="quick-actions-header">
                                <h3 class="quick-actions-title">
                                    <i class="fas fa-bolt"></i>
                                    Quick Actions
                                </h3>
                            </div>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn" onclick="showAdminSection('upload')">
                                    <i class="fas fa-plus"></i>
                                    Add New Unit
                                </button>
                                <button class="quick-action-btn" onclick="showAdminSection('manage')">
                                    <i class="fas fa-cog"></i>
                                    Manage Content
                                </button>
                                <button class="quick-action-btn" onclick="exportPlatformData()">
                                    <i class="fas fa-download"></i>
                                    Export Data
                                </button>
                                <button class="quick-action-btn" onclick="resetAllStats()">
                                    <i class="fas fa-trash-restore"></i>
                                    Reset Stats
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Platform Status -->
                    <div class="status-section">
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">
                                    <i class="fas fa-server"></i>
                                    Platform Status
                                </h3>
                                <div class="status-indicator online">
                                    <div class="status-dot"></div>
                                    Online
                                </div>
                            </div>
                            <div class="status-content">
                                <div class="status-item">
                                    <div class="status-label">Last Updated:</div>
                                    <div class="status-value" id="lastUpdated">Never</div>
                                </div>
                                <div class="status-item">
                                    <div class="status-label">Platform Version:</div>
                                    <div class="status-value">Notes Dock v1.0</div>
                                </div>
                                <div class="status-item">
                                    <div class="status-label">Database:</div>
                                    <div class="status-value">LocalStorage</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>

</html>